webpackJsonp([7],{109:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__lib_scroll_vue__=__webpack_require__(83),__WEBPACK_IMPORTED_MODULE_0__lib_scroll_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__lib_scroll_vue__),friends={template:"#friends"};__webpack_exports__.default={data:function(){return{counter:1,num:10,pageStart:0,pageEnd:0,listdata:[],downdata:[],user:{}}},methods:{getList:function(){var t=this;t.$http.get(web.API_PATH+"mood/query/friend/page/_userId_/1/"+t.num).then(function(e){t.downdata=e.data.data.rows,t.downdata=xqzs.mood.initMoodsData(t.downdata),console.log(t.downdata),t.$nextTick(function(){myResizePicture($(".friends_mood"),"friendImgList","li")})},function(t){console.log("error")})},onRefresh:function(t){this.getList(),t()},onInfinite:function(t){var e=this,o=this;o.$http.get(web.API_PATH+"mood/query/friend/page/_userId_/"+(o.counter+1)+"/"+o.num).then(function(i){o.counter++,o.pageEnd=o.num*o.counter,o.pageStart=o.pageEnd-o.num;var n=i.data.data.rows,a=0;o.pageEnd;for(n=xqzs.mood.initMoodsData(n);a<n.length;a++)o.downdata.push(n[a]);if(o.$nextTick(function(){myResizePicture($(".friends_mood"),"friendImgList","li")}),0===n.length)return e.$el.querySelector(".load-more").style.display="none",void(e.$el.querySelector(".load-finish").style.display="block");t()},function(t){console.log("error")})},showBigImg:function(t,e){for(var o=e.bigUrl,i=[],n=0;n<t.length;n++)i.push(t[n].bigUrl);wx.previewImage({current:o,urls:i})},addCare:function(t,e){var o=this;t.userId!==o.user.id&&o.$http.put(web.API_PATH+"mood/care/add",{moodId:t.id,userId:null}).then(function(t){1===t.data.status&&(o.downdata[e].caremy=o.user.id,o.$set(o.downdata,e,o.downdata[e]),o.downdata=xqzs.mood.initMoodsData(o.downdata),console.log(o.downdata))})},commentOrDel:function(t,e,o,i){var n=this;t===n.user.id?n._delComment(e,o,i):n.addComment(e,o,i)},_delComment:function(t,e,o){var i=this;xqzs.weui.actionSheet("删除我的评论?","删除",function(){var n=web.API_PATH+"mood/reply/_userId_/"+t;i.$http.delete(n).then(function(t){1===t.data.status?(i.downdata[e].replies[o].isDel=!0,i.downdata[e].replycount=i.downdata[e].replycount-1,i.$set(i.downdata,e,i.downdata[e])):xqzs.weui.toast("fail","删除失败",function(){})}).catch(function(t){})},function(){})},addComment:function(t,e,o){var i=this,n="";void 0!==o&&o&&(n=i.downdata[e].replies[o].fromuserid===i.downdata[e].userId?"作者":i.downdata[e].replies[o].from_nickName),xqzs.mood.actionSheetEdit("取消","发送",function(o){i.$http.put(web.API_PATH+"mood/reply/add",{moodId:i.downdata[e].id,userId:null,replyId:t,content:o}).then(function(t){1===t.data.status&&(xqzs.weui.toast("success","提交成功",function(){}),t.data.data.reply.touserid===i.downdata[e].userId&&(t.data.data.reply.to_nickName="作者"),i.downdata[e].replycount=t.data.data.mood.replycount,i.downdata[e].replies.push(t.data.data.reply),i.$set(i.downdata,e,i.downdata[e]))},function(t){}),console.log(o)},function(t){console.log(t)},"回复 "+n)},showComment:function(t,e){var o=this;o.downdata[e].isShowComment?(o.downdata[e].isShowComment=!1,o.$set(o.downdata,e,o.downdata[e])):(!0!==o.downdata[e].isAsk&&o.$http.get(web.API_PATH+"mood/care/query/comment/"+t).then(function(t){o.downdata[e].isAsk=!0,1===t.data.status&&(t.data.data.care.length>0||t.data.data.reply.length>0)&&(o.downdata[e].hasComments=!0,o.downdata[e].careList=t.data.data.care,o.downdata[e].commentList=t.data.data.reply,o.downdata[e].isShowComment=!0),console.log(t.data.data),o.$set(o.downdata,e,o.downdata[e])},function(t){console.log("error")}),o.downdata[e].isShowComment=!0,o.$set(o.downdata,e,o.downdata[e]))},formatContent:function(t){return xqzs.face.parse(t)}},mounted:function mounted(){var _this=this;this.getList(),this.$http({method:"GET",type:"json",url:web.API_PATH+"user/find/by/user/Id/_userId_"}).then(function(data){null!==data.data.data&&(_this.user=eval(data.data.data))},function(t){})},components:{"v-scroll":__WEBPACK_IMPORTED_MODULE_0__lib_scroll_vue___default.a}}},150:function(t,e,o){e=t.exports=o(0)(),e.push([t.i,".friend_header{border-bottom:1px solid #eee;background:#fff;padding:10px 0}.friend_header a{width:90%;height:24px;line-height:24px;text-align:center;background:#eee;margin:0 auto;font-size:12px;border:1px solid #eee;border-radius:5px;color:#999;display:block}.friends_mood{margin-top:1px;background:#fff;padding:10px 20px 10px 10px}.friendHeaderImg{width:40px;height:40px;display:block;border-radius:3px;float:left}.friendState{margin-left:55px}.mood_state{display:block}.mood_state,.mood_text{font-size:15px;margin-bottom:10px}.mood_text{color:#333}.stateBottom{height:30px;font-size:12px}.time{font-size:12px;color:#999;float:left;line-height:30px}.time_right{color:#999;float:right}.friendsLoc{font-size:12px;color:#516591}.time_right img{float:left}.frined_zan{float:left;margin-right:3px}.frined_com{float:left;margin-right:5px}.time_rightimg1{width:22px;margin-top:-3px;margin-right:10px}.time_rightimg2{margin-top:2px;width:18px}.friendImgList{overflow:hidden;margin-bottom:15px}.friendImgList.two li{width:7.5rem;height:6rem}.friendImgList.one li{width:10.7rem;height:8.1rem}.friendImgList li{float:left;margin-right:.3125rem;width:4.8675rem;height:4.8675rem;overflow:hidden;position:relative}.commont_box{padding-top:10px;background:#f9f9f9;border-radius:5px;position:relative;margin-top:10px;padding-bottom:15px;padding-left:10px}.arrow{width:15px;height:15px;background:#f9f9f9;position:absolute;left:20px;top:-6px;transform:rotate(45deg)}.friend_commont{margin-bottom:6px;font-size:13px}.name{font-size:14px;color:#669}.commont{font-size:14px;color:#333}",""])},191:function(t,e,o){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{position:"relative"}},[i("v-scroll",{attrs:{"on-refresh":t.onRefresh,"on-infinite":t.onInfinite}},[i("div",{staticClass:"friends_box"},[i("div",{staticClass:"friend_header"},[i("router-link",{attrs:{to:"/friendList"}},[t._v("以下是我关注的朋友，猜猜TA是谁？")])],1),t._v(" "),t._l(t.downdata,function(e,n){return i("div",{key:n,staticClass:"friends_mood"},[i("img",{staticClass:"friendHeaderImg",attrs:{src:e.randomFaceUrl,alt:""}}),t._v(" "),i("div",{staticClass:"friendState"},[i("span",{staticClass:"mood_state",class:{unhappy_txt_color:e.moodValue<=4,happy_txt_color:e.moodValue>4}},[t._v(t._s(e.moodValueText))]),t._v(" "),i("p",{staticClass:"mood_text",domProps:{innerHTML:t._s(t.formatContent(e.content))}}),t._v(" "),e.haspicture?i("ul",{staticClass:"friendImgList"},t._l(e.pics,function(o){return i("li",[i("img",{style:o.styleObject,attrs:{src:o.smallUrl,"data-bigPic":o.bigUrl,"data-w":o.picwidth,"data-h":o.picheight},on:{click:function(i){t.showBigImg(e.pics,o)}}})])})):t._e(),t._v(" "),i("div",{staticClass:"friendsLoc"},[t._v(t._s(e.address))]),t._v(" "),i("div",{staticClass:"stateBottom"},[i("div",{staticClass:"time"},[t._v(t._s(e.outTime))]),t._v(" "),i("div",{staticClass:"time_right"},[i("span",{staticClass:"frined_zan"},[t._v(t._s(e.careCount))]),t._v(" "),i("img",{staticClass:"time_rightimg1",staticStyle:{width:"26px"},attrs:{src:e.careImg,alt:""},on:{click:function(o){t.addCare(e,n)}}}),t._v(" "),i("span",{staticClass:"frined_com"},[t._v(t._s(e.replycount))]),t._v(" "),i("img",{staticClass:"time_rightimg2",staticStyle:{width:"20px"},attrs:{src:o(69),alt:""},on:{click:function(o){t.addComment(e.id,n)}}})])]),t._v(" "),e.replies.length>0?i("div",{staticClass:"commont_box"},[i("div",{staticClass:"arrow"}),t._v(" "),t._l(e.replies,function(o,a){return o.isDel?t._e():i("div",{key:a,staticClass:"friend_commont",on:{click:function(e){t.commentOrDel(o.fromuserid,o.id,n,a)}}},[0==o.tomoodreplyid||null==o.tomoodreplyid?i("span",{staticClass:"name"},[o.fromuserid==e.userId?[t._v("作者")]:t._e(),t._v(" "),o.fromuserid!=e.userId?[t._v(t._s(o.from_nickName))]:t._e(),t._v("\n                                :")],2):t._e(),t._v(" "),0!=o.tomoodreplyid&&null!=o.tomoodreplyid?[i("span",{staticClass:"name"},[o.fromuserid==e.userId?[t._v("作者")]:t._e(),t._v(" "),o.fromuserid!=e.userId?[t._v(t._s(o.from_nickName))]:t._e()],2),t._v(" 回复 "),i("span",{staticClass:"name"},[t._v(t._s(o.to_nickName)+":")])]:t._e(),t._v(" "),i("span",{staticClass:"commont"},[t._v(t._s(o.content))])],2)})],2):t._e()])])})],2)])],1)},staticRenderFns:[]}},219:function(t,e,o){var i=o(150);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(1)("27f75d9f",i,!0)},48:function(t,e,o){o(219);var i=o(2)(o(109),o(191),null,null);t.exports=i.exports},69:function(t,e,o){t.exports=o.p+"comments.png"},79:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{offset:{type:Number,default:40},enableInfinite:{type:Boolean,default:!0},enableRefresh:{type:Boolean,default:!0},onRefresh:{type:Function,default:void 0,required:!1},onInfinite:{type:Function,default:void 0,require:!1}},data:function(){return{top:0,state:0,startY:0,touching:!1,infiniteLoading:!1,height:"height:100px"}},mounted:function(){this.height="height:"+document.body.clientHeight+"px"},methods:{touchStart:function(t){this.startY=t.targetTouches[0].pageY,this.startScroll=this.$el.scrollTop||0,this.touching=!0},touchMove:function(t){if(this.enableRefresh&&!(this.$el.scrollTop>0)&&this.touching){var e=t.targetTouches[0].pageY-this.startY-this.startScroll;e>0&&t.preventDefault(),this.top=Math.pow(e,.8)+(2===this.state?this.offset:0),2!==this.state&&(this.top>=this.offset?this.state=1:this.state=0)}},touchEnd:function(t){if(this.enableRefresh){if(this.touching=!1,2===this.state)return this.state=2,void(this.top=this.offset);this.top>=this.offset?this.refresh():(this.state=0,this.top=0)}},refresh:function(){this.state=2,this.top=this.offset,this.onRefresh(this.refreshDone)},refreshDone:function(){this.state=0,this.top=0},infinite:function(){this.infiniteLoading=!0,this.onInfinite(this.infiniteDone)},infiniteDone:function(){this.infiniteLoading=!1},onScroll:function(t){if(this.enableInfinite&&!this.infiniteLoading){var e=this.$el.clientHeight;this.$el.querySelector(".inner").clientHeight-e-this.$el.scrollTop-(this.onRefresh?this.$el.querySelector(".pull-refresh").clientHeight:0)<this.$el.querySelector(".load-more").clientHeight&&this.infinite()}}}}},81:function(t,e,o){e=t.exports=o(0)(),e.push([t.i,"body,html{height:100%}.yo-scroll{position:absolute;top:0;right:0;bottom:0;left:0;overflow:auto;-webkit-overflow-scrolling:touch;background:#f5f5f5}.yo-scroll .inner{position:absolute;top:-2rem;width:100%;transition-duration:.3s}.yo-scroll .pull-refresh{position:relative;left:0;top:0;width:100%;height:2rem;display:flex;align-items:center;justify-content:center}.yo-scroll.touch .inner{transition-duration:0ms}.yo-scroll.down .down-tip,.yo-scroll.refresh .refresh-tip,.yo-scroll.up .up-tip{display:block}.yo-scroll .down-tip,.yo-scroll .refresh-tip,.yo-scroll .up-tip{display:none}.yo-scroll .load-more{height:3rem;display:flex;align-items:center;justify-content:center}.yo-scroll .load-finish{height:2rem;text-align:center}",""])},83:function(t,e,o){o(85);var i=o(2)(o(79),o(84),null,null);t.exports=i.exports},84:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"yo-scroll",class:{down:0===t.state,up:1==t.state,refresh:2===t.state,touch:t.touching},style:t.height,on:{touchstart:function(e){t.touchStart(e)},touchmove:function(e){t.touchMove(e)},touchend:function(e){t.touchEnd(e)},scroll:function(e){(t.onInfinite||t.infiniteLoading)&&t.onScroll(e)}}},[o("section",{staticClass:"inner",style:{transform:"translate3d(0, "+t.top+"px, 0)"}},[o("header",{staticClass:"pull-refresh"},[t._t("pull-refresh",[o("span",{staticClass:"down-tip"},[t._v("下拉更新")]),t._v(" "),o("span",{staticClass:"up-tip"},[t._v("松开更新")]),t._v(" "),o("span",{staticClass:"refresh-tip"},[t._v("更新中")])])],2),t._v(" "),t._t("default"),t._v(" "),o("footer",{staticClass:"load-more"},[t._t("load-more",[o("span",[t._v("下拉加载更多")])])],2),t._v(" "),o("footer",{staticClass:"load-finish",staticStyle:{display:"none"}},[t._t("load-finish",[o("span",[t._v("已经加载完成")])])],2)],2)])},staticRenderFns:[]}},85:function(t,e,o){var i=o(81);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(1)("18db66ab",i,!0)}});
//# sourceMappingURL=7.build.js.map