webpackJsonp([34],{120:function(t,e,i){i(620);var o=i(1)(i(263),i(552),null,null);t.exports=o.exports},151:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(66);e.default={props:{offset:{type:Number,default:40},enableInfinite:{type:Boolean,default:!0},enableRefresh:{type:Boolean,default:!0},onRefresh:{type:Function,default:void 0,required:!1},onInfinite:{type:Function,default:void 0,require:!1},isPageEnd:!1,isShowMoreText:{type:Boolean,default:!0},isNotRefresh:!0,cutHeight:0},data:function(){return{top:0,state:0,startY:0,touching:!1,infiniteLoading:!1,height:"height:100px"}},mounted:function(){var t=this;t.cutHeight||(t.cutHeight=0),this.height="height:"+(document.body.clientHeight-t.cutHeight)+"px",this.loadMoreText(),o.a.$on("scrollMoreTextInit",function(e){t.isShowMoreText=e,t.loadMoreText()}),o.a.$on("scrollHeightInit",function(e){t.cutHeight=e,t.initHeight()})},methods:{initHeight:function(){this.height="height:"+(document.body.clientHeight-this.cutHeight)+"px"},touchStart:function(t){this.startY=t.targetTouches[0].pageY,this.startScroll=this.$el.scrollTop||0,this.touching=!0},touchMove:function(t){if(this.enableRefresh&&!(this.$el.scrollTop>0)&&this.touching){var e=t.targetTouches[0].pageY-this.startY-this.startScroll;e>0&&t.preventDefault(),this.top=Math.pow(e,.8)+(2===this.state?this.offset:0),2!==this.state&&(this.top>=this.offset?this.state=1:this.state=0)}},touchEnd:function(t){if(this.enableRefresh){if(this.touching=!1,2===this.state)return this.state=2,void(this.top=this.offset);this.top>=this.offset?this.refresh():(this.state=0,this.top=0),this.loadMoreText()}},refresh:function(){this.state=2,this.top=this.offset,this.isNotRefresh?this.refreshDone():this.onRefresh(this.refreshDone)},refreshDone:function(){this.state=0,this.top=0},loadMoreText:function(){console.log(this.isShowMoreText),this.isShowMoreText?this.isPageEnd?($(".load-more").hide(),$(".load-finish").show()):($(".load-finish").hide(),$(".load-more").show()):($(".load-more").hide(),$(".load-finish").hide())},infinite:function(){console.log("Loading"),this.infiniteLoading=!0,this.onInfinite(this.infiniteDone)},infiniteDone:function(){console.log("done"),this.infiniteLoading=!1},onScroll:function(t){if(this.enableInfinite&&!this.infiniteLoading){var e=this.$el.clientHeight;this.$el.querySelector(".inner").clientHeight-e-this.$el.scrollTop-(this.onRefresh?this.$el.querySelector(".pull-refresh").clientHeight:0)<this.$el.querySelector(".load-more").clientHeight&&this.infinite()}}}}},152:function(t,e,i){e=t.exports=i(0)(),e.push([t.i,"body,html{height:100%}.yo-scroll{position:absolute;top:0;right:0;bottom:0;left:0;overflow:auto;-webkit-overflow-scrolling:touch;background:#f5f5f5}.yo-scroll .inner{position:absolute;top:-2rem;width:100%;transition-duration:.3s}.yo-scroll .pull-refresh{position:relative;left:0;top:0;width:100%;height:2rem;display:flex;align-items:center;justify-content:center}.yo-scroll.touch .inner{transition-duration:0ms}.yo-scroll.down .down-tip,.yo-scroll.refresh .refresh-tip,.yo-scroll.up .up-tip{display:block}.yo-scroll .down-tip,.yo-scroll .refresh-tip,.yo-scroll .up-tip{display:none}.yo-scroll .load-more{height:3rem;display:flex;align-items:center;justify-content:center;text-align:center}.yo-scroll .load-finish{height:2rem;text-align:center}.loadFont{font-size:12px;color:#999}",""])},153:function(t,e,i){i(155);var o=i(1)(i(151),i(154),null,null);t.exports=o.exports},154:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yo-scroll",class:{down:0===t.state,up:1==t.state,refresh:2===t.state,touch:t.touching},style:t.height,on:{touchstart:function(e){t.touchStart(e)},touchmove:function(e){t.touchMove(e)},touchend:function(e){t.touchEnd(e)},scroll:function(e){(t.onInfinite||t.infiniteLoading)&&t.onScroll(e)}}},[i("section",{staticClass:"inner",style:{transform:"translate3d(0, "+t.top+"px, 0)"}},[i("header",{staticClass:"pull-refresh"},[t._t("pull-refresh",[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isNotRefresh,expression:"!isNotRefresh"}]},[i("span",{staticClass:"down-tip loadFont"},[t._v("下拉更新")]),t._v(" "),i("span",{staticClass:"up-tip loadFont"},[t._v("松开更新")]),t._v(" "),i("span",{staticClass:"refresh-tip loadFont"},[t._v("更新中")])])])],2),t._v(" "),t._t("default"),t._v(" "),i("footer",{staticClass:"load-more"},[t._t("load-more",[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.infiniteLoading,expression:"!infiniteLoading"}],staticClass:"loadFont"},[t._v("上拉加载更多")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.infiniteLoading,expression:"infiniteLoading"}],staticClass:"loadFont"},[t._v("数据加载中..")])])],2),t._v(" "),i("footer",{staticClass:"load-finish",staticStyle:{display:"none"}},[t._t("load-finish",[i("span",{staticClass:"loadFont"},[t._v("已经加载完成")])])],2)],2)])},staticRenderFns:[]}},155:function(t,e,i){var o=i(152);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(2)("18db66ab",o,!0)},263:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(153);i.n(o);e.default={data:function(){return{pageNo:1,num:20,newNotices:[],pageStart:0,pageEnd:0,isNew:1,detailUrl:"/moodDetail?moodId="}},filters:{shortName:function(t,e){return xqzs.shortname(t,e)}},mounted:function(){var t=this;this.$http({method:"GET",type:"json",url:web.API_PATH+"notice/find/newNotices/_userId_"}).then(function(e){if(t.newNotices=e.data.data.rows,t.newNotices.length>0){t.newNotices=xqzs.mood.initMoodsData(t.newNotices);for(var i=0;i<t.newNotices.length;i++)t.newNotices[i].addtime=xqzs.dateTime.formatTime(t.newNotices[i].addtime)}else t.$http({method:"GET",type:"json",url:web.API_PATH+"notice/find/notices/_userId_/"+t.$route.query.time}).then(function(e){if(t.newNotices=e.data.data.rows,t.newNotices.length>0){t.newNotices=xqzs.mood.initMoodsData(t.newNotices);for(var i=0;i<t.newNotices.length;i++)t.newNotices[i].addtime=xqzs.dateTime.formatTime(t.newNotices[i].addtime)}},function(t){})},function(t){}),this.$http({method:"post",type:"json",url:web.API_PATH+"notice/update/read/_userId_/"+t.$route.query.time}).then(function(t){},function(t){}),xqzs.wx.setConfig(t)},methods:{formatContent:function(t){return xqzs.face.parse(t)},checkMore:function(){var t=this;t.$http.get(web.API_PATH+"notice/query/page/_userId_/"+t.pageNo+"/"+t.num).then(function(e){var i=e.data.data.rows;i=xqzs.mood.initMoodsData(i);for(var o=0;o<i.length;o++){var n=!0;if(i[o].addtime=xqzs.dateTime.formatTime(i[o].addtime),t.pageNo<=2){for(var s=0;s<t.newNotices.length;s++)if(i[o].id==t.newNotices[s].id){n=!1;break}n&&t.newNotices.push(i[o])}else t.newNotices.push(i[o])}0===i.length?t.isNew=2:t.isNew=0},function(t){console.log("error")}),t.pageNo=t.pageNo+1}}}},349:function(t,e,i){e=t.exports=i(0)(),e.push([t.i,".noticeStatus{padding:8px 0 8px 2px;line-height:15px}.notice_div .careStatus img{width:14px}.notice_div .noticeName{color:#5e61a2}.nobg{background:none!important}.bottom{width:100%;padding-bottom:20px;padding-top:20px;color:#999;text-align:center;font-size:14px}.notice_box{height:100%;background:#fff}.notice_list{overflow:hidden;border-bottom:1px solid#eee;padding:10px 15px;color:#000;display:block}.notice_img{height:44px;width:44px;display:block;float:left;border-radius:3px}.notice_div{float:left;margin-left:10px;width:12rem;padding-top:2px}.notice_div div{font-size:13px;color:#000;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:13px}.noticeText{padding:8px 0 8px 2px}.notice_div img{width:14px;display:block}.notice_div p{color:#999;font-size:12px;line-height:12px}.notice_content{width:60px;height:60px;float:right;overflow:hidden;position:relative;font-size:13px;color:#666}.picMood{height:32px;width:32px;display:block;position:absolute;top:50%;left:50%;margin-top:-16px;margin-left:-16px}.picContent{height:60px;width:60px}",""])},552:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"notice_box"},[i("div",{directives:[{name:"title",rawName:"v-title"}]},[t._v("消息")]),t._v(" "),i("v-scroll",{attrs:{"on-refresh":t.onRefresh,"on-infinite":t.onInfinite}},t._l(t.newNotices,function(e){return i("router-link",{staticClass:"notice_list",attrs:{to:t.detailUrl+e.moodid}},[i("img",{staticClass:"notice_img",attrs:{src:e.faceUrl,alt:""}}),t._v(" "),i("div",{staticClass:"notice_div"},[i("div",{staticClass:"noticeName"},[t._v(t._s(t._f("shortName")(e.nickName,7)))]),t._v(" "),e.content?i("div",{staticClass:"noticeText"},[t._v(t._s(e.content))]):t._e(),t._v(" "),"care"==e.tp?i("div",{staticClass:"noticeStatus"},[i("img",{attrs:{src:e.careImg,alt:""}})]):t._e(),t._v(" "),i("p",[t._v(t._s(e.addtime))])]),t._v(" "),i("div",{staticClass:"notice_content",class:{nobg:""!=e.moodcontent&&null!=e.moodcontent}},[e.moodpicture?i("img",{staticClass:"picContent",attrs:{src:e.moodpicture}}):""!=e.moodcontent&&null!=e.moodcontent?i("div",{domProps:{innerHTML:t._s(t.formatContent(e.moodcontent))}}):i("img",{staticClass:"picMood",attrs:{src:e.moodValueUrl}})])])})),t._v(" "),i("div",{staticClass:"bottom"},[1==t.isNew?i("a",{attrs:{id:"btnViewMore"},on:{click:function(e){t.checkMore()}}},[t._v("查看更早的消息...")]):0==t.isNew?i("a",{on:{click:function(e){t.checkMore()}}},[t._v("加载更多")]):i("a",[t._v("没有更多数据")])])],1)},staticRenderFns:[]}},620:function(t,e,i){var o=i(349);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(2)("67a6fe4d",o,!0)}});
//# sourceMappingURL=34.build.js.map?5c7fdce1