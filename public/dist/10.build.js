webpackJsonp([10],{101:function(t,i,e){e(586);var s=e(1)(e(243),e(518),null,null);t.exports=s.exports},146:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default={data:function(){return{}}}},147:function(t,i,e){i=t.exports=e(0)(),i.push([t.i,"",""])},148:function(t,i,e){e(150);var s=e(1)(e(146),e(149),null,null);t.exports=s.exports},149:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement;t._self._c;return t._m(0)},staticRenderFns:[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{staticClass:"weui-mask_transparent"}),t._v(" "),e("div",{staticClass:"weui-toast"},[e("i",{staticClass:"weui-loading weui-icon_toast"}),t._v(" "),e("p",{staticClass:"weui-toast__content"},[t._v("数据加载中")])])])}]}},150:function(t,i,e){var s=e(147);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(2)("5de0c1c0",s,!0)},151:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(66);i.default={props:{offset:{type:Number,default:40},enableInfinite:{type:Boolean,default:!0},enableRefresh:{type:Boolean,default:!0},onRefresh:{type:Function,default:void 0,required:!1},onInfinite:{type:Function,default:void 0,require:!1},isPageEnd:!1,isShowMoreText:{type:Boolean,default:!0},isNotRefresh:!0,cutHeight:0},data:function(){return{top:0,state:0,startY:0,touching:!1,infiniteLoading:!1,height:"height:100px"}},mounted:function(){var t=this;t.cutHeight||(t.cutHeight=0),this.height="height:"+(document.body.clientHeight-t.cutHeight)+"px",this.loadMoreText(),s.a.$on("scrollMoreTextInit",function(i){t.isShowMoreText=i,t.loadMoreText()}),s.a.$on("scrollHeightInit",function(i){t.cutHeight=i,t.initHeight()})},methods:{initHeight:function(){this.height="height:"+(document.body.clientHeight-this.cutHeight)+"px"},touchStart:function(t){this.startY=t.targetTouches[0].pageY,this.startScroll=this.$el.scrollTop||0,this.touching=!0},touchMove:function(t){if(this.enableRefresh&&!(this.$el.scrollTop>0)&&this.touching){var i=t.targetTouches[0].pageY-this.startY-this.startScroll;i>0&&t.preventDefault(),this.top=Math.pow(i,.8)+(2===this.state?this.offset:0),2!==this.state&&(this.top>=this.offset?this.state=1:this.state=0)}},touchEnd:function(t){if(this.enableRefresh){if(this.touching=!1,2===this.state)return this.state=2,void(this.top=this.offset);this.top>=this.offset?this.refresh():(this.state=0,this.top=0),this.loadMoreText()}},refresh:function(){this.state=2,this.top=this.offset,this.isNotRefresh?this.refreshDone():this.onRefresh(this.refreshDone)},refreshDone:function(){this.state=0,this.top=0},loadMoreText:function(){console.log(this.isShowMoreText),this.isShowMoreText?this.isPageEnd?($(".load-more").hide(),$(".load-finish").show()):($(".load-finish").hide(),$(".load-more").show()):($(".load-more").hide(),$(".load-finish").hide())},infinite:function(){console.log("Loading"),this.infiniteLoading=!0,this.onInfinite(this.infiniteDone)},infiniteDone:function(){console.log("done"),this.infiniteLoading=!1},onScroll:function(t){if(this.enableInfinite&&!this.infiniteLoading){var i=this.$el.clientHeight;this.$el.querySelector(".inner").clientHeight-i-this.$el.scrollTop-(this.onRefresh?this.$el.querySelector(".pull-refresh").clientHeight:0)<this.$el.querySelector(".load-more").clientHeight&&this.infinite()}}}}},152:function(t,i,e){i=t.exports=e(0)(),i.push([t.i,"body,html{height:100%}.yo-scroll{position:absolute;top:0;right:0;bottom:0;left:0;overflow:auto;-webkit-overflow-scrolling:touch;background:#f5f5f5}.yo-scroll .inner{position:absolute;top:-2rem;width:100%;transition-duration:.3s}.yo-scroll .pull-refresh{position:relative;left:0;top:0;width:100%;height:2rem;display:flex;align-items:center;justify-content:center}.yo-scroll.touch .inner{transition-duration:0ms}.yo-scroll.down .down-tip,.yo-scroll.refresh .refresh-tip,.yo-scroll.up .up-tip{display:block}.yo-scroll .down-tip,.yo-scroll .refresh-tip,.yo-scroll .up-tip{display:none}.yo-scroll .load-more{height:3rem;display:flex;align-items:center;justify-content:center;text-align:center}.yo-scroll .load-finish{height:2rem;text-align:center}.loadFont{font-size:12px;color:#999}",""])},153:function(t,i,e){e(155);var s=e(1)(e(151),e(154),null,null);t.exports=s.exports},154:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"yo-scroll",class:{down:0===t.state,up:1==t.state,refresh:2===t.state,touch:t.touching},style:t.height,on:{touchstart:function(i){t.touchStart(i)},touchmove:function(i){t.touchMove(i)},touchend:function(i){t.touchEnd(i)},scroll:function(i){(t.onInfinite||t.infiniteLoading)&&t.onScroll(i)}}},[e("section",{staticClass:"inner",style:{transform:"translate3d(0, "+t.top+"px, 0)"}},[e("header",{staticClass:"pull-refresh"},[t._t("pull-refresh",[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isNotRefresh,expression:"!isNotRefresh"}]},[e("span",{staticClass:"down-tip loadFont"},[t._v("下拉更新")]),t._v(" "),e("span",{staticClass:"up-tip loadFont"},[t._v("松开更新")]),t._v(" "),e("span",{staticClass:"refresh-tip loadFont"},[t._v("更新中")])])])],2),t._v(" "),t._t("default"),t._v(" "),e("footer",{staticClass:"load-more"},[t._t("load-more",[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.infiniteLoading,expression:"!infiniteLoading"}],staticClass:"loadFont"},[t._v("上拉加载更多")]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.infiniteLoading,expression:"infiniteLoading"}],staticClass:"loadFont"},[t._v("数据加载中..")])])],2),t._v(" "),e("footer",{staticClass:"load-finish",staticStyle:{display:"none"}},[t._t("load-finish",[e("span",{staticClass:"loadFont"},[t._v("已经加载完成")])])],2)],2)])},staticRenderFns:[]}},155:function(t,i,e){var s=e(152);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(2)("18db66ab",s,!0)},243:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(66),a=e(153),o=e.n(a),n=e(148),r=e.n(n);i.default={data:function(){return{habits:[],list:[],page:1,row:14,isPageEnd:!1,isShowMoreText:!1,showLoad:!1,animit:!1,timeout:null,smallOrBigAnimt:!1,timeout2:null}},mounted:function(){this.getList()},methods:{orderHabits:function(t,i){for(var e=[],s=0;s<t.length;s++)t[s].big=!1,t[s].todayAdded&&e.push(t[s]),i&&i==t[s].id&&(t[s].big=!0);for(var a=0;a<t.length;a++)t[a].todayAdded||e.push(t[a]),i&&i==t[a].id&&(t[a].big=!0);return e},delOrAddHabit:function(t){var i=this;if(console.log("delOrAddHabit:"+i.smallOrBigAnimt),!i.smallOrBigAnimt){for(var e=0;e<this.habits.length;e++)this.habits[e].small=!1;var s=this.habits[t];i.habits[t].small=!0,i.smallOrBigAnimt=!0,this.$set(this.habits,t,this.habits[t]),1==s.todayAdded?this.delHabit(t):this.addHabit(t)}},addHabit:function(t){var i=this;if(1!=i.animit){for(var e=0,s=0;s<i.habits.length;s++)1==i.habits[s].todayAdded&&e++;e+1==i.habits.length&&(i.animit=!0);var a=i.habits[t].id;i.$http.put(web.API_PATH+"habit/put/habit/today/_userId_/"+a,{}).then(function(s){if(e+1==i.habits.length&&(i.timeout=setTimeout(function(){i.animit=!1},3200)),1===s.data.status){i.habits[t].todayAdded=1,i.$set(i.habits,t,i.habits[t]),i.habits=i.orderHabits(i.habits,i.habits[t].id);for(var a=0,o=0;o<i.habits.length;o++)1==i.habits[o].todayAdded&&a++;1==a&&xqzs.coin.addAminate(xqzs.coin.constant.HABIT_TYPE),i.timeout2&&clearTimeout(i.timeout2),i.timeout2=setTimeout(function(){for(var t=0;t<i.habits.length;t++)i.habits[t].small=!1,i.habits[t].big=!1;i.smallOrBigAnimt=!1},740),i.$nextTick(function(){$(".my_habit .item .img").css({"background-size":"64%"})})}})}},delHabit:function(t){var i=this;i.showLoad=!0;var e=i.habits[t].id;i.$http.put(web.API_PATH+"habit/del/habit/today/_userId_/"+e,{}).then(function(e){i.showLoad=!1,1===e.data.status&&(i.habits[t].todayAdded=0,i.$set(i.habits,t,i.habits[t]),i.habits=i.orderHabits(i.habits,i.habits[t].id),i.timeout2&&clearTimeout(i.timeout2),i.timeout2=setTimeout(function(){for(var t=0;t<i.habits.length;t++)i.habits[t].small=!1,i.habits[t].big=!1;i.smallOrBigAnimt=!1},740),i.$nextTick(function(){$(".my_habit .item .img").css({"background-size":"64%"})}))})},getList:function(t){var i=this,e=web.API_PATH+"habit/get/home/page/_userId_/"+i.page+"/"+i.row;i.isLoading||i.isPageEnd||(1==i.page&&(i.showLoad=!0),i.isLoading=!0,i.$http.get(e).then(function(e){if(t&&"function"==typeof t&&t(),i.showLoad=!1,i.isLoading=!1,1!=e.data.status)return void(i.list=[]);i.habits=e.data.data.habits,i.habits=i.orderHabits(i.habits);var a=e.data.data.habitList;a.length<i.row?(i.isPageEnd=!0,i.isShowMoreText=!1):i.isShowMoreText=!0,s.a.$emit("scrollMoreTextInit",i.isShowMoreText),1==i.page?i.list=a:i.list=i.list.concat(a),i.$nextTick(function(){$(".my_habit .item .img").css({"background-size":"64%"})}),0!=a.length&&(i.page=i.page+1)},function(t){i.isLoading=!1,i.showLoad=!1}))},onInfinite:function(t){this.getList(t)},onRefresh:function(t){this.counter=1,this.isPageEnd=!1,this.getList(t)},goStatistics:function(){this.$router.push("/habit/statistics")},goCard:function(){this.$router.push("/habit/card")},goAdd:function(){this.$router.push("/habit/add")}},components:{"v-scroll":o.a,"v-showLoad":r.a}}},315:function(t,i,e){i=t.exports=e(0)(),i.push([t.i,'.habit_box,.habit_box .yo-scroll{background:#fff}.habit_box .my_habit{padding:.6rem .88235rem;padding-bottom:1rem;border-bottom:.5588235294117647rem solid #f5f5f5}.habit_box .my_habit .item{width:25%;float:left;text-align:center;color:#999;font-size:.7058823529411765rem;margin-top:.8rem;line-height:1}.habit_box .my_habit .item .img{display:inline-block;border:1px solid hsla(0,0%,85%,.5);height:2.9411764705882355rem;width:2.9411764705882355rem;border-radius:50%;font-size:2rem;line-height:2.7rem;overflow:hidden}.habit_box .my_habit .item .txt{color:#999;margin-top:.4rem}.habit_box .my_habit .item.on .img{border:1px solid rgba(255,153,0,.5)}.habit_box .my_habit .item.on .txt{color:#666}.habit_box .my_habit .item.small{-webkit-animation:item_small .35s;animation:item_small .35s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}@keyframes item_small{0%{transform:scale(1);-webkit-transform:scale(1)}to{transform:scale(0);-webkit-transform:scale(0)}}.habit_box .my_habit .item.big{-webkit-animation:item_big .35s;animation:item_big .35s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}@keyframes item_big{0%{transform:scale(0);-webkit-transform:scale(0)}to{transform:scale(1);-webkit-transform:scale(1)}}.habit_box .habit_history{position:relative;overflow:hidden;padding-bottom:.5rem}.habit_box .habit_history .title{color:#4a4949;font-size:.8235294117647058rem;padding-left:.88235rem;padding-top:.6rem}.habit_box .habit_history .item .time{font-size:.7058823529411765rem;color:#999;float:left;line-height:2rem;margin-left:.88235rem;width:2rem}.habit_box .habit_history:before{width:1px;height:100%;background:#eee;content:" ";display:block;position:absolute;top:3rem;left:3.4rem}.habit_box .habit_history.nolinee:before{display:none}.habit_box .habit_history .item .day_habits img{height:1.2rem}.habit_box .habit_history .item .day_habits{line-height:2.2rem;margin-left:1.4rem;float:left}.habit_box .habit_history .item .day_habits span{display:inline-block;width:2.3rem;text-align:center}.habit_box .habit_history .item{position:relative}.habit_box .habit_history .item:before{content:"";display:block;position:absolute;top:.8rem;left:3.3rem;height:.29411764705882354rem;width:.29411764705882354rem;border-radius:50%;background:#f90}.habit_box .history_ts{color:#999;font-size:.7rem;line-height:1.8823529411764706rem;padding-left:2.45rem;margin-top:-.4rem;margin-bottom:1rem}.habit_box .history_ts:before{content:" ";display:inline-block;height:1.8823529411764706rem;width:1.8823529411764706rem;background:url('+e(409)+") no-repeat;background-size:1.8823529411764706rem;float:left;margin-right:.6rem}.habit_btns{position:fixed;bottom:2rem;right:1.2rem}.habit_btns .btn{height:2.4rem;width:2.6rem;background:#f90;border-radius:3px;text-align:center;color:#fff;font-size:.82rem;padding-top:.3rem;margin-bottom:1rem}.habit_btns .btn:active{background:#e38000}.habit_btns .btn_s .img{background:url("+e(408)+") no-repeat 50%;background-size:44%;height:1rem;width:100%}.habit_btns .btn_card .img{background:url("+e(407)+") no-repeat 50%;background-size:44%;height:1rem;width:100%}.habit_box .addHabit{width:9.882352941176471rem;height:9.882352941176471rem;position:fixed;top:50%;left:50%;margin-left:-4.9411764705882355rem;margin-top:-4.9411764705882355rem;-webkit-animation:big 3.5s;animation:big 3.5s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.habit_box .addHabit .r{background:url("+e(411)+") no-repeat;background-size:100%;height:100%;-webkit-animation:round 2.5s;animation:round 2.5s;animation-delay:.5s;-webkit-animation-delay:.5s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.habit_box .addHabit .good{background:url("+e(410)+") no-repeat;background-size:7.705882352941176rem;width:7.705882352941176rem;height:6.911764705882353rem;position:absolute;left:1.088235294117647rem;top:1.485294117647059rem}@keyframes big{0%{transform:translate3d(0,-260px,0) scale(0);-webkit-transform:translate3d(0,-260px,0) scale(0)}10%{transform:translate3d(0,40px,0) scale(1);-webkit-transform:translate3d(0,40px,0) scale(1)}16%{transform:translate3d(0,-60px,0) scale(1);-webkit-transform:translate3d(0,-60px,0) scale(1)}18%{transform:translate3d(0,20px,0) scale(1);-webkit-transform:translate3d(0,20px,0) scale(1)}20%{transform:translateZ(0) scale(1);-webkit-transform:translateZ(0) scale(1)}92%{transform:translateZ(0) scale(1);-webkit-transform:translateZ(0) scale(1)}to{transform:translate3d(0,-260px,0) scale(0);-webkit-transform:translate3d(0,-260px,0) scale(0)}}@keyframes round{0%{opacity:1;transform:rotate(0deg);-webkit-transform:rotate(0deg)}80%{opacity:1;transform:rotate(1turn);-webkit-transform:rotate(1turn)}to{opacity:0;transform:rotate(1turn);-webkit-transform:rotate(1turn)}}",""])},407:function(t,i,e){t.exports=e.p+"habit_btn_card.png"},408:function(t,i,e){t.exports=e.p+"habit_btn_s.png"},409:function(t,i,e){t.exports=e.p+"habit_history_ts.png"},410:function(t,i,e){t.exports=e.p+"habit_today_add_good.png"},411:function(t,i,e){t.exports=e.p+"habit_today_add_good_r.png"},518:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"habit_box"},[t.showLoad?e("v-showLoad"):t._e(),t._v(" "),e("div",{directives:[{name:"title",rawName:"v-title"}]},[t._v("今日习惯")]),t._v(" "),e("v-scroll",{attrs:{"on-refresh":t.onRefresh,"on-infinite":t.onInfinite,isPageEnd:t.isPageEnd,isShowMoreText:t.isShowMoreText}},[e("div",{staticClass:"my_habit"},[t._l(t.habits,function(i,s){return e("div",{staticClass:"item ",class:{on:1==i.todayAdded,small:i.small,big:i.big},on:{click:function(i){t.delOrAddHabit(s)}}},[1==i.todayAdded?e("div",{staticClass:"img",style:"background: url("+i.iconFinish+") no-repeat center; background-size: 64%;"}):e("div",{staticClass:"img",style:"background: url("+i.iconNotFinish+") no-repeat center; background-size: 64%;"}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(i.title))])])}),t._v(" "),e("div",{staticClass:"item",on:{click:function(i){t.goAdd()}}},[e("div",{staticClass:"img"},[t._v("+")]),t._v(" "),e("div",{staticClass:"txt"},[t._v("新习惯")])]),t._v(" "),e("div",{staticClass:"clear"})],2),t._v(" "),e("div",{staticClass:"habit_history",class:{nolinee:0==t.list.length}},[e("div",{staticClass:"title"},[t._v("历史习惯")]),t._v(" "),t._l(t.list,function(i){return e("div",{staticClass:"item"},[i.day<10?e("div",{staticClass:"time"},[t._v(t._s(i.month)+".0"+t._s(i.day))]):e("div",{staticClass:"time"},[t._v(t._s(i.month)+"."+t._s(i.day))]),t._v(" "),e("div",{staticClass:"day_habits"},t._l(i.habits,function(i){return i.finish?e("span",[e("img",{attrs:{src:i.iconFinish}})]):t._e()})),t._v(" "),e("div",{staticClass:"clear"})])})],2),t._v(" "),t.list.length>0?e("div",{staticClass:"history_ts"},[e("span",[t._v("你开启了健康习惯之旅")])]):t._e()]),t._v(" "),e("div",{staticClass:"habit_btns"},[e("div",{staticClass:"btn btn_s",on:{click:function(i){t.goStatistics()}}},[e("div",{staticClass:"img"}),t._v(" "),e("div",{staticClass:"txt"},[t._v("统计")])]),t._v(" "),e("div",{staticClass:"btn btn_card",on:{click:function(i){t.goCard()}}},[e("div",{staticClass:"img"}),t._v(" "),e("div",{staticClass:"txt"},[t._v("卡片")])])]),t._v(" "),t.animit?e("div",{staticClass:"addHabit"},[e("div",{staticClass:"r"}),t._v(" "),e("div",{staticClass:"good"})]):t._e()],1)},staticRenderFns:[]}},586:function(t,i,e){var s=e(315);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(2)("045092fc",s,!0)}});
//# sourceMappingURL=10.build.js.map?5c7fdce1